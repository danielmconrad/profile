#!/bin/bash

set -e
set -x

YELLOw='\033[1;33m'
BLUE='\033[0;34m'
NC='\033[0m'

main (){
  #install_homebrew
  #install_profile
  #install_git
  install_node
  #install_ruby
  #install_go
  #install_python
  #install_apps

  #installing "Finished!"
}

install_homebrew() {
  if hash brew 2>/dev/null; then
    return 
  fi
  
  /usr/bin/ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"
}

install_profile() {
  installing "Homeshick"
  brew install -f homeshick
  
  rm -rf ~/.homesick/repos/profile
  
  homeshick clone -f -b danmconrad/profile
  homeshick link profile

  touch ~/.bash_profile

  if grep -q ".conrad-profile" "$HOME/.bash_profile"; then
    log "Bash Profile already sources .conrad-profile"
  else
    log "Sourcing .conrad-profile in .bash_profile"
    printf '\nsource "$HOME/.conrad-profile"' >> $HOME/.bash_profile
  fi
}

install_git() {
  installing "Git"
  brew install -f git
}

install_node() {
  installing "Node"
  brew uninstall nvm || echo "."
  brew install -f nvm
  nvm install 11
  nvm alias default 11

#   export NVM_DIR="$HOME/.nvm"
#   source "$(brew --prefix)/opt/nvm/nvm.sh"
}

install_ruby() {
  installing "Ruby"
  brew install -f rbenv
  rbenv install 2.6.2
  rbenv global 2.6.2
}

install_go() {
  installing "Go"
  brew install -f go
}

install_python() {
  installing "Python"
  brew install -f pyenv
  pyenv install 3.7.0
  pyenv global 3.7.0
}

install_apps() {
  installing "CLI Apps"
  brew install -f nmap
  
  installing "Vim"
  brew install -f vim

  installing "Chrome"
  brew cask install -f google-chrome

  installing "Docker"
  brew cask install -f docker

  installing "VSCode"
  brew cask install -f visual-studio-code

  installing "Spectacle"
  brew cask install -f spectacle

  installing "iTerm"
  brew cask install -f iterm2
  
  installing "Slack"
  brew cask install -f slack
}

installing() {
  echo "================================================="
  printf "${YELLOw}[PROFILE]${NC} $1\n"
  echo "================================================="
}

log() {
  printf "${BLUE}[PROFILE]${NC} $1\n"
}

main
